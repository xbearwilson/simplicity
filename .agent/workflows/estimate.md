---
description: 任務評估與 Token 使用量預估
---

# 任務評估流程

當使用者提出任務需求時，按照以下步驟進行評估：

## 1. 分析任務範圍

仔細分析使用者的需求，識別：

- 需要讀取的文件數量和類型
- 需要創建/修改的文件數量
- 需要執行的命令數量
- 任務的複雜度（簡單/中等/複雜）

## 2. 列出執行步驟

將任務分解為具體步驟，例如：

- 步驟 1: 讀取配置文件
- 步驟 2: 分析現有代碼
- 步驟 3: 生成新文件
- 步驟 4: 執行測試
- 步驟 5: 生成報告

## 3. 預估 Token 使用量

根據任務類型提供粗略估計：

### 小型任務 (< 10,000 tokens)

- 讀取 1-3 個文件
- 修改/創建 1-2 個文件
- 簡單的代碼生成
- 示例：修改單個組件、更新配置文件

### 中型任務 (10,000 - 30,000 tokens)

- 讀取 4-10 個文件
- 修改/創建 3-8 個文件
- 中等複雜度的代碼生成
- 示例：創建新功能模塊、重構組件

### 大型任務 (30,000 - 60,000 tokens)

- 讀取 10-20 個文件
- 修改/創建 8-15 個文件
- 複雜的代碼生成和重構
- 示例：遷移框架、大規模重構

### 超大型任務 (> 60,000 tokens)

- 讀取 20+ 個文件
- 修改/創建 15+ 個文件
- 非常複雜的代碼生成
- 示例：完整專案遷移、多模塊重寫

## 4. 檢查當前 Token 餘額

查看系統提示中的 token 使用情況：

- 剩餘 > 100,000: 可以執行大型任務
- 剩餘 50,000-100,000: 可以執行中型任務
- 剩餘 20,000-50,000: 建議執行小型任務或分批
- 剩餘 < 20,000: 只執行小型任務

## 5. 提供建議

根據評估結果，提供以下格式的回覆：

```markdown
## 📊 任務評估報告

### 任務概述

[簡述任務內容]

### 執行步驟

1. [步驟 1]
2. [步驟 2]
3. [步驟 3]
   ...

### Token 使用預估

- **預估消耗**: [範圍] tokens
- **任務規模**: [小型/中型/大型/超大型]
- **當前剩餘**: [數量] tokens
- **風險評估**: [低/中/高]

### 執行建議

- ✅ **建議方式**: [一次執行 / 分 X 批執行]
- 📋 **分批方案** (如適用):
  - 批次 1: [內容] (~X tokens)
  - 批次 2: [內容] (~X tokens)
  - 批次 3: [內容] (~X tokens)

### 結論

[是否建議立即執行 / 建議分批執行 / 建議等待更多 tokens]
```

## 6. 詢問使用者確認

在提供評估報告後，詢問：**「開始執行此任務？(y/n)」**

等待使用者回覆：

- **y** 或 **yes**: 立即開始執行
- **n** 或 **no**: 等待進一步指示（分批執行/修改範圍/暫緩）

## 注意事項

1. **保守估計**: 預估時寧可高估，避免執行到一半 token 不足
2. **實時更新**: 在執行過程中，定期報告當前 token 使用情況
3. **檢查點**: 對於大型任務，在關鍵步驟完成後詢問是否繼續
4. **靈活調整**: 如果實際消耗超出預估，主動建議暫停並分批

## 使用方式

使用者可以通過以下方式觸發此評估流程：

- 直接輸入: `@[/estimate]`
- 或在任務描述前加上: "請先評估這個任務"
- 或使用模板格式提問
